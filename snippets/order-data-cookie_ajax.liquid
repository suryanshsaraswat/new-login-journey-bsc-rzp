<script>
  // Getting the UTM parameters from a URL
const urlParams = new URLSearchParams(window.location.search);
const utmSource = urlParams.get('utm_source');
const utmMedium = urlParams.get('utm_medium');
const utmCampaign = urlParams.get('utm_campaign');

// Getting the order data from the Shopify order variable
const orderNumber = {{ order.order_number }};
const orderTotal = {{ order.total_price | money_without_currency }};

// Creating a new cookie with the fetched order data and the UTM parameters as a JSON object
const orderData = {
  orderNumber: orderNumber,
  orderTotal: orderTotal,
  utmSource: utmSource,
  utmMedium: utmMedium,
  utmCampaign: utmCampaign
};
document.cookie = `order_data_utm=${JSON.stringify(orderData)}; path=/`;

// Send the order data to a server-side script using an AJAX request
// const xhr = new XMLHttpRequest();
// xhr.open('POST', '/path/to/server-side-script.php');
// xhr.setRequestHeader('Content-Type', 'application/json');
// xhr.onreadystatechange = function() {
//   if (xhr.readyState === XMLHttpRequest.DONE) {
//     // Handle the server's response
//     console.log(xhr.responseText);
//   }
// };
// xhr.send(JSON.stringify(orderData));
</script>
